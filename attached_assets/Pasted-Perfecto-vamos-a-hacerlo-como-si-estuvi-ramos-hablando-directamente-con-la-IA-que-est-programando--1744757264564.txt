Perfecto, vamos a hacerlo como si estuviéramos hablando directamente con la IA que está programando el software. Voy a explicarle la lógica exacta, paso a paso, y basándome en cómo funcionan las secciones del software: Facturas, Transacciones y las tarjetas resumen (“Ingresos”, “Gastos”, “Resultado Final”).

⸻

ESTRUCTURA DEL SOFTWARE Y SU LÓGICA FINANCIERA

1. SECCIÓN: “FACTURAS”

Cada factura creada en el sistema representa un ingreso potencial o real, dependiendo del estado que manejes (por ejemplo: pendiente, pagada, anulada).
Si trabajas con facturas ya cobradas, entonces cada factura debe tener su reflejo automático en la sección de Transacciones -> Ingresos.

⸻

2. SECCIÓN: “TRANSACCIONES”

En esta sección tenemos 2 tipos:
	•	Ingresos: Dinero que entra (facturas cobradas, ventas, ingresos directos, etc.)
	•	Gastos: Dinero que sale (compras, pagos, nóminas, etc.)

⸻

REGLA FUNDAMENTAL: Sincronización Facturas-Ingresos

Cada factura = una transacción de ingreso.

Cada transacción de ingreso = una factura.

Estas dos entidades deben estar enlazadas entre sí, y si se modifica o elimina una, la otra también debe actualizarse o eliminarse.

⸻

FUNCIONES QUE TU IA DEBE IMPLEMENTAR

A. Al CREAR una factura:
	1.	Registrar la factura en la base de datos (con campos como cliente, importe, fecha, etc.).
	2.	Crear automáticamente una transacción de ingreso con los mismos datos.
	3.	Añadir esta transacción a la lista de ingresos.
	4.	Recalcular:
	•	Total ingresos
	•	Resultado final

Ejemplo:

Factura creada por 100€ -> Transacción de ingreso por 100€ -> Tarjeta de ingresos +100€ -> Resultado final actualizado.

⸻

B. Al ELIMINAR una factura:
	1.	Buscar la transacción de ingreso que tiene el mismo ID o esté relacionada con esa factura.
	2.	Eliminar la transacción.
	3.	Actualizar:
	•	Tarjeta de ingresos (-importe)
	•	Resultado final (se resta también)

⸻

C. Al CREAR una transacción de ingreso directamente (desde Transacciones):
	1.	Crear la transacción de ingreso en la base de datos.
	2.	Crear automáticamente una factura asociada con los mismos datos.
	3.	Añadir el ingreso a la suma total.
	4.	Actualizar tarjetas.

⸻

D. Al ELIMINAR una transacción de ingreso:
	1.	Buscar la factura relacionada.
	2.	Eliminar también esa factura.
	3.	Actualizar:
	•	Tarjeta de ingresos
	•	Resultado final

⸻

E. Al CREAR una transacción de GASTO:
	1.	Añadir a la lista de transacciones de gastos.
	2.	Actualizar:
	•	Tarjeta de gastos (+importe)
	•	Resultado final (-importe)

⸻

F. Al ELIMINAR una transacción de GASTO:
	1.	Restar ese importe de la suma total de gastos.
	2.	Recalcular el resultado final.

⸻

CÁLCULO DE TARJETAS

Tarjeta de INGRESOS

totalIngresos = sumarTodasLasTransacciones(tipo = "ingreso")

Tarjeta de GASTOS

totalGastos = sumarTodasLasTransacciones(tipo = "gasto")

Tarjeta de RESULTADO FINAL

resultadoFinal = totalIngresos - totalGastos

Estas tarjetas deben actualizarse en tiempo real cada vez que se cree, edite o elimine una transacción o factura.

⸻

RELACIÓN ENTRE ENTIDADES (IMPORTANTE)

Tu IA debe asegurar que cada entidad tenga referencias cruzadas:

Factura {
  id: "f123",
  cliente: "Carlos",
  importe: 200,
  fecha: "2025-04-16",
  transaccionId: "t123"
}

Transaccion {
  id: "t123",
  tipo: "ingreso",
  facturaId: "f123",
  importe: 200,
  fecha: "2025-04-16"
}

Así puedes buscar fácilmente y sincronizar ambas entidades.

⸻

¿Quieres que le dé ejemplos de funciones en JavaScript o en el lenguaje que estás usando para que tu IA los pueda replicar directamente?